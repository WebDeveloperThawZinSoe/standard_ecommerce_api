$(function(){if(new Date().getTimezoneOffset()/60==-8&&Intl.DateTimeFormat().resolvedOptions().timeZone=='Asia/Shanghai'){$('.list .items-list li.item .item-discount').remove()
$('.list .items-list li.item').each(function(){var vprice=$(this).find('.currency_converter .price').attr('lkr');var tprice=$(this).find('.sum .price').attr('lkr');if(parseFloat(vprice)>parseFloat(tprice)){$(this).find('.sum').remove();$(this).find('.oldPrice').remove();$(this).find('.currency_converter').show();$(this).attr('price',vprice);}else{$(this).find('.currency_converter').remove();$(this).find('.sum').show();}});$('.recommended-goods-buy div.item').each(function(){var vprice=$(this).find('.currency_converter .price').attr('lkr');var tprice=$(this).find('.sum .price').attr('lkr');if(parseFloat(vprice)>parseFloat(tprice)){$(this).find('.sum').remove();$(this).find('.oldPrice').remove();$(this).find('.currency_converter').show();$(this).attr('price',vprice);}else{$(this).find('.currency_converter').remove();$(this).find('.sum').show();}});}else{$('.currency_converter').remove();$('.sum').show();}
if($(window).width()+8>1024){$('.main').css('min-height',$(window).height()-$('.fixed-header').outerHeight(true)-$('.footer').outerHeight(true)+180);}else{$('.main').css('min-height',$(window).height()-$('.fixed-header').outerHeight(true)-$('.mobile_footer').outerHeight(true)+60);}
var inputFocustext='';$('body').on('focus','input[type=text]',function(){if($(this).hasClass('searchInput')){return false;}
inputFocustext=$(this).attr('placeholder');$(this).attr('placeholder','');});$('body').on('blur','input[type=text]',function(){if($(this).hasClass('searchInput')){return false;}
$(this).attr('placeholder',inputFocustext);});var currentHref=location.href;$('.nav .nav-help-menu li').each(function(){if($(this).find('a').attr('href')==currentHref){$(this).find('a').addClass('active');}});$('.right .lang-currency').hover(function(){if($(window).width()+8>1024){$(this).find('.curr-content').addClass('display');}},function(){if($(window).width()+8>1024){$(this).find('.curr-content').removeClass('display');$('.lang-box-c').slideUp();$('.right .lang-currency .lang-box-t .arrow').removeClass('show');}});$('.right .lang-currency').click(function(e){$(this).find('.curr-content').addClass('display');});$('.right .lang-currency .lang-box-t').click(function(){$(this).siblings('.lang-box-c').slideToggle(100);$(this).find('.arrow').toggleClass('show');});$('.right .sign-btn,.right .login-btn').hover(function(){if($(this).hasClass('sign-btn')){$(this).siblings('.account-bg').css({left:'50%'});}else{$(this).siblings('.account-bg').css({left:'0'});}},function(){$(this).siblings('.account-bg').css({left:'50%'});});let hoverFlag=false;$('.nav .cart').hover(function(){if($(window).width()+8>1024){$(this).find('.cart-link').addClass('display');$(this).find('.cart-link ul').addClass('hover-show');if(!hoverFlag){cartGoodsInit();}}},function(){if($(window).width()+8>1024){if($(this).find('.cart-link ul').hasClass('show')){}else{$(this).find('.cart-link').removeClass('display');}
$(this).find('.cart-link ul').removeClass('hover-show');}});$('.mobile_cart').click(function(){$('.nav .cart .cart-link').addClass('display');$('body').css('overflow','hidden');if(!hoverFlag){cartGoodsInit();}});$('.nav .cart .cart-link .mobile__cart--title i.close_ico').click(function(){$('.nav .cart .cart-link').removeClass('display');$('body').css('overflow','auto');});$(window).resize(function(){$('body').css('overflow','auto');});$('.header .search .input-box input').focus(function(){$(this).siblings('i').addClass('focus');});$('.header .search .input-box input').blur(function(){$(this).siblings('i').removeClass('focus');});$('.right .account').on('click','a',function(){var type=$(this).attr('datatype');$('.wrapper').show();$('.modal').show();$('.wrapper .dialog').each(function(){if($(this).attr('datatype')==type){$(this).addClass('display');grecaptcha.reset();}});if(type==2){calculateTime();}});$('.nav .menu .choose-game').click(function(){if($('.nav .menu .menu-box').hasClass('display')){$('.nav .menu .menu-box').removeClass('display');}else{$('.nav .menu .menu-box').addClass('display');if(!$('.nav .menu .menu-box').hasClass('lazy')){$('.nav .menu .menu-box a img').each(function(){$(this).attr('src',$(this).attr('data-src'));});}
$('.nav .menu .menu-box').addClass('lazy');}});$('.wrapper .sign').on('click','button',function(){signAjax();});$('.wrapper .login').on('click','button',function(){loginAjax();});$('.shade .shade_list span').click(function(){var type=$(this).attr('type');$.ajax({url:siteUrl+'/login/thirdLoginConnect/'+type,type:'get',success:function(res){location.href=res.data.url;}});});function loginAjax(){$('.login .input-box').removeClass('required');$('.tips').remove();var username,pwd,usernameReq,pwdReq;username=$('.login .email .username').val();pwd=$('.login .pass .password').val();usernameReq=/^[\w\.\-]+@[\w\.\-]+(\.\w+)+$/;pwdReq=/^[a-zA-Z0-9]{6,}$/;var status=$('.wrapper .login .checked input').prop('checked');if(status){var keep_login='1';}else{var keep_login='0';}
if(username==''){validation($(".login .email .input-box"),$('.login .email .username'),"This field is required");$(".login .email .username").focus();return false;}else{if(!usernameReq.test(username)){validation($(".login .input-box"),$('.login .email .username'),"Please enter a valid email address");$(".login .email .username").focus();return false;}}
if(pwd==''){validation($(".login .input-box"),$('.login .pass .password'),"This field is required");$(".login .pass .password").focus();return false;}else{if(pwd.trim().length<6){validation($(".login .input-box"),$('.login .pass .password'),"Password length should be minimum 6 characters");$(".login .pass .password").focus();return false;}}
var recaptchaResponse=$('#google_key').val();if(!recaptchaResponse){$('.wrapper .login button i').hide();$('.wrapper .login button').after('<div class="errorTips"><p><i class="ico"></i>ERROR</p><span>'+'Please check the captcha'+'</span></div>');$('.wrapper .login button').addClass('error');setTimeout(function(){$('.errorTips').remove();$('.wrapper .login button').attr('disabled',false);$('.wrapper .login button span').show();$('.wrapper .login button').removeClass('error');},2000);return false;}
$.ajax({url:siteUrl+'/login/index',type:'post',dataType:'json',data:{email:username,password:pwd,keep_login:keep_login,recaptchaResponse:recaptchaResponse},beforeSend:function(){$('.wrapper .login button span').hide();$('.wrapper .login button i').css('display','block');$('.wrapper .login button').attr('disabled',true);},success:function(res){if(res.code==0){window.location.reload();}else{$('.wrapper .login button i').hide();$('.wrapper .login button').after('<div class="errorTips"><p><i class="ico"></i>ERROR</p><span>'+res.msg+'</span></div>');$('.wrapper .login button').addClass('error');setTimeout(function(){$('.errorTips').remove();$('.wrapper .login button').attr('disabled',false);$('.wrapper .login button span').show();$('.wrapper .login button').removeClass('error');},2000);}},error:function(){setTimeout(function(){$('.errorTips').remove();$('.wrapper .login button i').hide();$('.wrapper .login button').attr('disabled',false);$('.wrapper .login button span').show();$('.wrapper .login button').removeClass('error');},2000);}});}
function signAjax(){$('.sign .input-box').removeClass('required');$(".tips").remove();var username,pwd,repwd,usernameReq,pwdReq;username=$('.sign .email .username').val();pwd=$('.sign .pass .password').val();repwd=$('.sign .repass .repwd').val();usernameReq=/^[\w\.\-]+@[\w\.\-]+(\.\w+)+$/;pwdReq=/^[a-zA-Z0-9]{6,}$/;if(username==''){validation($(".sign .email .input-box"),$('.sign .email .username'),"This field is required");$(".sign .email .username").focus();return false;}else{if(!usernameReq.test(username)){validation($(".sign .input-box"),$('.sign .email .username'),"Please enter a valid email address");$(".sign .email .username").focus();return false;}}
if(pwd==''){validation($(".sign .input-box"),$('.sign .pass .password'),"This field is required");$(".sign .pass .password").focus();return false;}else{if(pwd.trim().length<6){validation($(".sign .input-box"),$('.sign .pass .password'),"Password length should be minimum 6 characters");$(".sign .pass .password").focus();return false;}}
if(pwd!==repwd){validation($(".sign .input-box"),$('.sign .repass .repwd'),"Password does not match");$(".sign .repass .repwd").focus();return false;}
var accept_check=$('.accept input').prop('checked');if(accept_check===false){$(".sign .input-box").removeClass("required");$(".tips").remove();$('.sign .accept').append($('<div class="tips" style="color:#ff0000;margin-top: 5px;font-size: 12px">'+'This field is required check'+"</div>"));$(".sign .accept input").addClass("required");$(".sign .accept").focus();return false;}
$.ajax({url:siteUrl+'/register/index',type:'post',dataType:'json',data:{email:username,password:pwd,password_confirm:repwd,},beforeSend:function(){$('.wrapper .sign button span').hide();$('.wrapper .sign button i').css('display','block');$('.wrapper .sign button').attr('disabled',true);},success:function(res){if(res.code==0){window.location.reload();}else{$('.wrapper .sign button i').hide();$('.wrapper .sign button').addClass('error');$('.wrapper .sign button').after('<div class="errorTips"><p><i class="ico"></i>ERROR</p><span>'+res.msg+'</span></div>');setTimeout(function(){$('.errorTips').remove();$('.wrapper .sign button span').show();$('.wrapper .sign button').removeClass('error');$('.wrapper .sign button').attr('disabled',false);},2000);}},error:function(){setTimeout(function(){$('.wrapper .sign button i').hide();$('.errorTips').remove();$('.wrapper .sign button span').show();$('.wrapper .sign button').removeClass('error');$('.wrapper .sign button').attr('disabled',false);},2000);}});}
$('.wrapper .dialog input').keydown(function(e){if(e.which==13){if($('.wrapper .dialog.display').attr('datatype')==1){loginAjax();}else{signAjax();}}});function calculateTime(){var new_timestamp=Math.round(new Date().getTime()/1000);var valid_timestamp=localStorage['valid_timestamp'];$('.dif_text').text('');$('.dif_text').show();if(valid_timestamp==undefined||valid_timestamp<new_timestamp){$('.sign-up-btn').attr('disabled',false);$('.sign-up-btn').removeAttr('style');}else{$('.sign-up-btn').attr('disabled',true);$('.sign-up-btn').css({"background":"#b1b1a9"});countDown();int_count=self.setInterval(countDown,1000);}}
function countDown(){var new_timestamp=Math.round(new Date().getTime()/1000);var valid_timestamp=localStorage['valid_timestamp'];var dif_timestamp=valid_timestamp-new_timestamp;var dif_text='';if(dif_timestamp>60){var minute=parseInt(dif_timestamp/60);var second=dif_timestamp-(60*minute);dif_text=minute+'min'+second+'s';}else{dif_text=dif_timestamp+'s';}
if(dif_timestamp<=0){clearInterval(int_count);$('.sign-up-btn').attr('disabled',false);$('.sign-up-btn').removeAttr('style');$('.dif_text').hide();}else{$('.dif_text').text('（'+dif_text+'）');}}
function validation(parent,ele,tip){parent.removeClass("required");ele.parent(".input-box").addClass("required");$(".tips").remove();ele.parent(".input-box").append($('<div class="tips">'+tip+"</div>"));}
$('.wrapper .dialog i.close-ico').click(function(){$('.wrapper').hide();$('.modal').hide();$('.wrapper .dialog').removeClass('display');$.removeCookie('iggm_bind_user');});$('.login-to-sign').click(function(){$('.wrapper').show();$('.modal').show();$('.wrapper .login').addClass('display');$('.wrapper .sign').removeClass('display');$('.wrapper .binding').hide();});$('.sign-to-log').click(function(){$('.wrapper').show();$('.modal').show();$('.wrapper .sign').addClass('display');$('.wrapper .login').removeClass('display');$('.wrapper .binding').hide();});$('body').on('input','input.number-input',function(){var value=$(this).val();var val=value.replace(/[^0-9]/g,'');$(this).val(val);});var currenctLang=$('.header .right .lang-content .lang-box .lang-box-c a[data-type='+current_lang+'] p').text();$('.header .right .lang-content .lang-box .lang-box-t p').text(currenctLang);$('.header .right .language span.country').addClass(current_lang);$('.header .right .lang-content .lang-box .lang-box-c a').click(function(){var lang=$(this).attr('data-type');$.cookie('website_iggm_language',lang,{path:'/'});var lang=$(this).attr('data-type');var url=window.location.href;var urlArr=url.split('/');var urlStr='';for(var i=3;i<urlArr.length;i++){urlStr+='/'+urlArr[i];}
$('.header .right .lang-content .lang-box .lang-box-c a').each(function(){if(urlStr.indexOf('/'+$(this).attr('data-type'))!=-1){urlStr=urlStr.replace('/'+$(this).attr('data-type'),'');}});if(urlStr==''){if(lang=='en'){location.href=default_siteHost;}else{location.href=default_siteHost+'/'+lang;}}else{if(urlStr!='/'){if(lang!='en'){location.href=default_siteHost+'/'+lang+urlStr;}else{location.href=default_siteHost+urlStr;}}else{if(lang!='en'){location.href=default_siteHost+'/'+lang;}else{location.href=default_siteHost;}}}});$('body').on('click',function(e){if(!$('.nav .menu').is(e.target)&&$('.nav .menu').has(e.target).length===0){$('.nav .menu .menu-box').removeClass('display');}
if(!$('.header .right ul .lang-currency').is(e.target)&&$('.header .right ul .lang-currency').has(e.target).length===0){$('.header .right ul .lang-currency .lang-content').removeClass('display');}});$('.header .curr-content .currency-box .lang-box-c a').click(function(e){$('.header .curr-content .currency-box .lang-box-c').stop(false).slideUp(100);var rate=$(this).attr('data-rate');var currency_name=$(this).find('p').text();var symbol=$(this).find('span').text();localStorage['rate']=rate;localStorage['currency_name']=currency_name;$.cookie('cur_name',currency_name,{path:'/'});localStorage['symbol']=symbol;$('.header .lang-currency p.curr-name').attr('data-rate',rate);$('.header .lang-currency p.curr-name').text(currency_name);$('.header .curr-content .currency-box span.curr-code').text(symbol);$('.header .lang-currency p.curr-code').text(localStorage["symbol"]);getNewRate(currency_name);if($(window).width()+8<=1024){$('.header .lang-currency .lang-content').removeClass('display');e.stopPropagation();}
setTimeout(function(){priceCalc();},100);});setCurrency();function setCurrency(){if(!localStorage["currency_name"]||!localStorage["symbol"]||!localStorage["rate"]){localStorage["currency_name"]=currency.code;localStorage["symbol"]=currency.symbol;localStorage["rate"]=currency.rate;$.cookie('cur_name',currency.code,{path:'/'});}else{$.cookie('cur_name',localStorage["currency_name"]);}
$('.header .lang-currency p.curr-name').attr('data-rate',localStorage["rate"]);$('.header .lang-currency p.curr-name').text(localStorage["currency_name"]);$('.header .lang-currency p.curr-code').text(localStorage["symbol"]);$('.header .curr-content .currency-box span.curr-code').text(localStorage["symbol"]);getNewRate(localStorage["currency_name"]);}
function getNewRate(currency_name){$.ajax({url:siteUrl+'/ajax/calculateRate',data:{currency_name:currency_name},type:'get',dataType:'json',success:function(res){if(res.code===1){var rate=res.data.rate;if(rate!=localStorage["rate"]){$('.header .lang-currency p.curr-name').attr('data-rate',rate);localStorage["rate"]=res.data.rate;priceCalc();}}}});}
function priceCalc(){var rate=$('.header .lang-currency>p.curr-name').attr('data-rate');var symbol=localStorage["symbol"];var price=$('.price');price.each(function(){$(this).find('strong').text(symbol);var lkr=$(this).attr('lkr');var price=(lkr*rate).toFixed(2);$(this).find('i').text(price);});var goods_price=$('.goods .goods-list .price');goods_price.each(function(){var lkr=$(this).attr('lkr');var num=$(this).parents('.item').find('.item-num input').val();var newLkr=num*lkr;var price=(newLkr*rate).toFixed(2);$(this).find('i').text(price);});if($('.shopcart .cart-list').length>0){var checkoutPirce=$('.shopcart .cart-list .price');checkoutPirce.each(function(){var lkr=$(this).attr('lkr');var num=$(this).parents('tr').find('input').val();var newLkr=num*lkr;var price=(newLkr*rate).toFixed(2);$(this).find('i').text(price);});var mobile_price=$('.shopcart .mobile_cart_list .price');mobile_price.each(function(){var lkr=$(this).attr('lkr');var num=$(this).parents('li').find('.goods-num input').val();var newLkr=num*lkr;var price=(newLkr*rate).toFixed(2);$(this).find('i').text(price);});}
var cPrice=$('.recommended-goods-buy .item .item-price .price');cPrice.each(function(){var lkr=$(this).attr('lkr');var num=$(this).parents('.item').find('.item-num input').val();var newLkr=num*lkr;var price=(newLkr*rate).toFixed(2);$(this).find('i').text(price);});}
function headerTopCartNum(){if(localStorage['cart']&&localStorage['cart']!=''){var HeaderShopCart=JSON.parse(decodeURIComponent(window.atob(localStorage.getItem("cart"))));var list=HeaderShopCart.list;if(list.length==1){$('.nav .cart .cart-total em').hide();}else{$('.nav .cart .cart-total em').show();}
$('.fixed-header .shopCount').text(list.length);}}
checkoutList();if($('.selltousBox').length==0){headerTopCartNum();headerCartFor();}
priceCalc();function headerCartFor(){if(!localStorage['cart']||localStorage['cart']==''){$('#headerCarts').html('');$('.cart .cart-link .noCart').show();$('.cart .cart-link .cart-total').hide();$('.cart .cart-link .cart-button').hide();return false;}
var HeaderShopCart=JSON.parse(decodeURIComponent(window.atob(localStorage.getItem("cart"))));let html=template('headerCart',HeaderShopCart);$('#headerCarts').html(html);let list=HeaderShopCart.list;var lkrprice=0;for(var i=0;i<list.length;i++){lkrprice=lkrprice+(list[i].num*list[i].price);}
$('.nav .cart .cart-link .cart-total .price').attr('lkr',lkrprice);if($('.shopcart .order-info').length>0){$('.shopcart .order-info .items-price .price').attr('lkr',lkrprice);}
if(list.length==0){$('.cart .cart-link .noCart').show();$('.cart .cart-link .cart-total').hide();$('.cart .cart-link .cart-button').hide();}else{$('.cart .cart-link .noCart').hide();$('.cart .cart-link .cart-total').show();$('.cart .cart-link .cart-button').show();}}
function checkoutList(){if($('#shoping-list').length>0&&$('.orderRePay').length==0){if(!localStorage['cart']||localStorage['cart']==''){$('#shoping-list').html('');$('.cart .cart-link .noCart').show();$('.cart .cart-link .cart-total').hide();$('.cart .cart-link .cart-button').hide();return false;}
cartGoodsInit();}}
function cartGoodsInit(){var shopCart=JSON.parse(decodeURIComponent(window.atob(localStorage.getItem("cart"))));var arraylist=shopCart.list;if(arraylist.length==0){return false;}
let dataArray=[];let obj={};for(var i=0;i<arraylist.length;i++){if(arraylist[i].boostingType==arraylist[i].game_sku){let boost_objs={}
if(arraylist[i].max_level&&arraylist[i].min_level){boost_objs={goods_no:arraylist[i].goods_no,start:arraylist[i].min_level,end:arraylist[i].max_level,additional:arraylist[i].remarkTitle};}else{boost_objs={goods_no:arraylist[i].goods_no,additional:arraylist[i].remarkTitle,number:arraylist[i].number};}
dataArray.push(boost_objs);}else{if(arraylist[i].min_level&&arraylist[i].min_level!=''){var boost_objs={goods_no:arraylist[i].goods_no,start:arraylist[i].min_level,end:arraylist[i].max_level,additional:arraylist[i].remarkTitle};dataArray.push(boost_objs);}else{if(arraylist[i].price_num){obj[arraylist[i].goods_no+'_'+arraylist[i].price_num]=arraylist[i].price_num;}else{obj[arraylist[i].goods_no+'_'+arraylist[i].num]=arraylist[i].num;}}}}
dataArray.unshift(obj);let goods_no=JSON.stringify(dataArray);$.ajax({url:siteUrl+'/cart/returnCurPrice',data:{goods_no:goods_no},type:'post',dataType:'json',success:function(res){var data=res.data;for(var i=0;i<data.length;i++){for(j=0;j<arraylist.length;j++){if(arraylist[i].boostingType==arraylist[i].game_sku){arraylist[j].price=data[i].price;}else{if(typeof arraylist[j].price_num=='undefined'){if(data[i].goods_no==arraylist[j].goods_no){arraylist[j].price=data[i].price;}}else{if(data[i].num==arraylist[j].price_num&&data[i].goods_no==arraylist[j].goods_no){arraylist[j].price=data[i].amount;}}}
if(data[i].goods_no==arraylist[j].goods_no){if(data[i].status!=1){arraylist.splice(j,1);}}}}
if(arraylist.length==0){if(siteUrl+'/cart'==document.referrer){location.href=siteUrl;}else{self.location=document.referrer;}}
hoverFlag=true;shopCart.list=arraylist;localStorage['cart']=window.btoa(window.encodeURIComponent(JSON.stringify(shopCart)));if($('#shoping-list').length>0){var html=template('pc_cart_goods',shopCart);var html1=template('mobile_cart_goods',shopCart);$('#shoping-list').html(html);$('.mobile_cart_list ul').html(html1);}
$('.cart-left .shoping-list-mask').remove();$('.cart-right .cart-goods-mask').remove();headerCartFor();headerTopCartNum();calcPaymentMethod();priceCalc();if($('.delivery-info').length>0){var game_sku=shopCart.list[0].game_sku;$('.delivery-info').load(siteUrl+'/cart/loadGameTemp/game_sku/'+game_sku,function(){if($('.tax-exclusive-price').length>0){var num=0;for(var i=0;i<arraylist.length;i++){num=num+(parseFloat(arraylist[i].price_num)*parseFloat(arraylist[i].num));}
var minMum=Math.ceil(((num*1000000/0.9)+(num*1000000*0.001))/1000)*1000;var maxMum=Math.ceil(((num*1000000/0.9)+(num*1000000*0.009))/1000)*1000;$('.tax-exclusive-price').find('input').attr('placeholder','Random Range ('+minMum+' - '+maxMum+')');$('.tax-exclusive-price').attr('max_num',maxMum);$('.tax-exclusive-price').attr('min_num',minMum);}});}}});}
function calcPaymentMethod(){var itemPrice=$('.items-price .price').attr('lkr');var payment=$('.payment-method .payment-info ul li');payment.each(function(){var fee=$(this).attr('data-num');var price=(0.5+(parseFloat(itemPrice)*fee));$(this).find('.hot-con .price').attr('lkr',price);$(this).find('.hot-con .price i').text((price*localStorage['rate']).toFixed(2));});}
var deleteFlag=false;$('.nav .cart .cart-link ul').on('click','li i.delete',function(){if(deleteFlag){return false;}
deleteFlag=true;$(this).parents('.cart-item').find('.delete-tips').addClass('display');if($(window).width()+8>1024){$('.nav .cart .cart-link ul').addClass('show');}
var that=$(this);setTimeout(function(){var HeaderShopCart=JSON.parse(decodeURIComponent(window.atob(localStorage.getItem("cart"))));var index=that.parent('li').index();HeaderShopCart.list.splice(index,1);if(HeaderShopCart.list.length==0){if($('.shopcart').length>0){location.reload();$('.main').css('min-height',$(window).height()-$('.footer').outerHeight(true));}}
if(HeaderShopCart.list.length==1){$('.nav .cart .cart-total em').hide();}else{$('.nav .cart .cart-total em').show();}
$('.fixed-header .shopCount').text(HeaderShopCart.list.length);localStorage['cart']=window.btoa(window.encodeURIComponent(JSON.stringify(HeaderShopCart)));headerCartFor();checkoutList();priceCalc();if($(window).width()+8>1024){$('.nav .cart .cart-link ul').removeClass('show');if(!$('.nav .cart .cart-link ul').hasClass('hover-show')){$('.nav .cart .cart-link').removeClass('display');}}
deleteFlag=false;},2000);});var shopCartIndex='';$('.shopcart .common_cart_list').on('click','.goods_li .delete',function(){shopCartIndex=$(this).parents('.goods_li').index();});$('body').on('click','.delete-modal-box.delete-one-box button.yes',function(){var HeaderShopCart=JSON.parse(decodeURIComponent(window.atob(localStorage.getItem("cart"))));HeaderShopCart.list.splice(shopCartIndex,1);if(HeaderShopCart.list.length==0){location.reload();$('.main').css('min-height',$(window).height()-$('.footer').outerHeight(true));}
if(HeaderShopCart.list.length==1){$('.nav .cart .cart-total em').hide();}else{$('.nav .cart .cart-total em').show();}
$('.fixed-header .shopCount').text(HeaderShopCart.list.length);localStorage['cart']=window.btoa(window.encodeURIComponent(JSON.stringify(HeaderShopCart)));headerCartFor();checkoutList();priceCalc();});$('body').on('click','.nav .cart button.clear-btn',function(){$('.main').append(deletePublicHtml);$('.modal').show();});$('body').on('click','.delete-public-box button.yes',function(){$('.delete-public-box').remove();$('.modal').hide();localStorage.removeItem('cart');$('.fixed-header .shopCount').text(0);headerCartFor();checkoutList();priceCalc();if($('.noCartDiv').length==0){}else{location.reload();$('.main').css('min-height',$(window).height()-$('.footer').outerHeight(true));}});$('body').on('click','.delete-public-box .delete-close',function(){$('.delete-public-box').remove();$('.modal').hide();});$('body').on('click','.list-buttom button.clear-btn',function(){$('.main').append(deletecartHtml);$('.delete-modal-box').removeClass('delete-one-box').addClass('delete-all-box');$('.waiting-modal').show();});$('body').on('click','.delete-modal-box.delete-all-box button.yes',function(){location.reload();$('.main').css('min-height',$(window).height()-$('.footer').outerHeight(true));$('.waiting-modal').hide();$('.delete-modal-box').removeClass('display');localStorage.removeItem('cart');$('.fixed-header .shopCount').text(0);});$('.common_cart_list').on('click','.shop-num span.sub',function(){var val=$(this).siblings('input').val();var min_num=$(this).siblings('input').attr('data-num');console.log(min_num);var length=min_num.length;var HeaderShopCart=JSON.parse(decodeURIComponent(window.atob(localStorage.getItem("cart"))));var index=$(this).parents('.goods_li').index();var that=$(this);if(val-min_num<min_num){var newsVal=min_num;}else{if(length>=3){var newsVal=val-100;}else if(length==2){var newsVal=val-10;}else{var newsVal=val-1;}}
$(this).siblings('input').val(newsVal);HeaderShopCart.list[index].num=newsVal;localStorage['cart']=window.btoa(window.encodeURIComponent(JSON.stringify(HeaderShopCart)));if($('#shoping-list').length>0){var html=template('pc_cart_goods',HeaderShopCart);var html1=template('mobile_cart_goods',HeaderShopCart);$('#shoping-list').html(html);$('.mobile_cart_list ul').html(html1);}
checkoutPrice(that,newsVal);headerCartFor();priceCalc();});$('.common_cart_list').on('click','.shop-num span.add',function(){var val=$(this).siblings('input').val();var min_num=$(this).siblings('input').attr('data-num');var max_num=$(this).siblings('input').attr('max');var length=min_num.length;var HeaderShopCart=JSON.parse(decodeURIComponent(window.atob(localStorage.getItem("cart"))));var index=$(this).parents('.goods_li').index();var that=$(this);if(parseFloat(val)>=max_num){var newsVal=max_num;}else{if(length>=3){var newsVal=parseFloat(val)+100;}else if(length==2){var newsVal=parseFloat(val)+10;}else{var newsVal=parseFloat(val)+1;}}
$(this).siblings('input').val(newsVal);HeaderShopCart.list[index].num=newsVal;localStorage['cart']=window.btoa(window.encodeURIComponent(JSON.stringify(HeaderShopCart)));if($('#shoping-list').length>0){var html=template('pc_cart_goods',HeaderShopCart);var html1=template('mobile_cart_goods',HeaderShopCart);$('#shoping-list').html(html);$('.mobile_cart_list ul').html(html1);}
checkoutPrice(that,newsVal);headerCartFor();priceCalc();});$('.common_cart_list').on('blur','.shop-num input',function(){var val=$(this).val();var min_num=$(this).attr('data-num');var HeaderShopCart=JSON.parse(decodeURIComponent(window.atob(localStorage.getItem("cart"))));var index=$(this).parents('.goods_li').index();var max_num=$(this).attr('max');var that=$(this);if(parseFloat(val)>=max_num){val=max_num;$(this).val(val);}
if(val==''||parseFloat(val)<min_num){$(this).val(min_num);val=min_num;}
HeaderShopCart.list[index].num=val;localStorage['cart']=window.btoa(window.encodeURIComponent(JSON.stringify(HeaderShopCart)));if($('#shoping-list').length>0){var html=template('pc_cart_goods',HeaderShopCart);var html1=template('mobile_cart_goods',HeaderShopCart);$('#shoping-list').html(html);$('.mobile_cart_list ul').html(html1);}
checkoutPrice(that,val);headerCartFor();priceCalc();});function checkoutPrice(that,num){var lkr=that.parents('tr').find('.price').attr('lkr');var rate=localStorage['rate'];var newLkr=num*lkr;var newsPrice=(newLkr*rate).toFixed(2);that.parents('tr').find('.price i').text(newsPrice);}
$('.logout').click(function(){localStorage.removeItem('cart');});var hotKeyword=[];var otherKeyword=[];$('.common_search input').on('focus',function(){$('.search-modal').show();if($('.common_search .search-key a').length>0){$('.common_search .search-key').addClass('display');}else{$.ajax({url:siteUrl+'/ajax/search_keyword',type:'get',success:function(res){if(res.data.hot){hotKeyword=res.data.hot;}
otherKeyword=res.data.other;var html='';if(hotKeyword.length>0){for(var i=0;i<hotKeyword.length;i++){html+='<a href="'+siteUrl+hotKeyword[i].url+'"><span>'+hotKeyword[i].keyword+'</span><img src="/static/pc/image/hotSearch.png"/></a>';}}else{for(var i=0;i<otherKeyword.length;i++){html+='<a href="'+siteUrl+otherKeyword[i].url+'"><span>'+otherKeyword[i].keyword+'</a>';}}
$('.common_search .search-key div').html(html);$('.common_search .search-key').addClass('display');}});}});$('.common_search input').on('input',function(){var val=$(this).val();if(val!=''){var newHot=hotKeyword.filter(function(item){return item.keyword.toLowerCase().indexOf(val.toLowerCase())>-1;});var newOther=otherKeyword.filter(function(item){return item.keyword.toLowerCase().indexOf(val.toLowerCase())>-1;});var html='';for(var i=0;i<newHot.length;i++){html+='<a href="'+siteUrl+newHot[i].url+'"><span>'+newHot[i].keyword+'</span><img src="/static/pc/image/hotSearch.png"/></a>';}
for(var i=0;i<newOther.length;i++){html+='<a href="'+siteUrl+newOther[i].url+'">'+newOther[i].keyword+'</a>';}}else{var html='';if(hotKeyword.length>0){for(var i=0;i<hotKeyword.length;i++){html+='<a href="'+siteUrl+hotKeyword[i].url+'"><span>'+hotKeyword[i].keyword+'</span><img src="/static/pc/image/hotSearch.png"/></a>';}}else{for(var i=0;i<otherKeyword.length;i++){html+='<a href="'+siteUrl+otherKeyword[i].url+'"><span>'+otherKeyword[i].keyword+'</a>';}}}
$('.common_search .search-key div').html(html);$('.common_search .search-key').addClass('display');});$('.common_search .search_ico').on('click',function(){var url=$(this).siblings('input').attr('data-url');location.href=url;});$('.search-modal').on('click',function(){$('.common_search .search-key').removeClass('display');$('.search-modal').hide();});$('.back-top-button').click(function(){$('html,body').animate({scrollTop:'0'},300);});$(window).scroll(function(){var top=$(this).scrollTop();if(top>500){$('.back-top-button').css('display','flex');}else{$('.back-top-button').hide();}});var u1='cfd';var u2='uid';var cy="";try{cy=window.btoa(Intl.DateTimeFormat().resolvedOptions().timeZone);}catch(e){}
SetCookie("_"+u1+u2,(new Date().getTimezoneOffset()*6356)+"/"+cy,{path:'/',expires:1000});function SetCookie(name,value,options){if(typeof value!='undefined'){options=options||{};if(value===null){value='';options.expires=-1;}
var expires='';if(options.expires&&(typeof options.expires=='number'||options.expires.toUTCString)){var date;if(typeof options.expires=='number'){date=new Date();date.setTime(date.getTime()+(options.expires*60*60*1000));}else{date=options.expires;}
expires='; expires='+date.toUTCString();}
var path=options.path?'; path='+(options.path):'';var domain=options.domain?'; domain='+(options.domain):'';var secure=options.secure?'; secure':'';document.cookie=[name,'=',encodeURIComponent(value),expires,path,domain,secure].join('');}else{var cookieValue=null;if(document.cookie&&document.cookie!==''){var cookies=document.cookie.split(';');for(var i=0;i<cookies.length;i++){var cookie=jQuery.trim(cookies[i]);if(cookie.substring(0,name.length+1)===(name+'=')){cookieValue=decodeURIComponent(cookie.substring(name.length+1));break;}}}
return cookieValue;}}
$('.header .right ul .lang-currency .lang-title').click(function(){$(this).siblings('.lang-curr-content').addClass('display');});$('.header .menu_ico').click(function(){$('.slide_menu').css({'opacity':'1'});$('.slide_menu').css({'left':'0'});$('.slide_modal').show();$('body').css({'overflow':'hidden'});$('.slide_menu .menu-nav ul li').each(function(){if($(this).find('img').attr('data-src')!=$(this).find('img').attr('src')){$(this).find('img').attr('src',$(this).find('img').attr('data-src'));}});});$('.slide_modal,.slide_menu .close').click(function(){$('.slide_menu').css({'left':'-100%'});$('.slide_menu').css({'opacity':'0'});$('.slide_modal').hide();$('body').css({'overflow':'auto'});});$('.slide_menu .menu-content .currency-language p').click(function(){$(this).siblings('ul').toggleClass('display');});$(window).resize(function(){hideLoginDialog();});hideLoginDialog();function hideLoginDialog(){if($(window).width()+8<=1024){$('.wrapper').hide();$('.modal').hide();$('.wrapper .dialog').removeClass('display');}}});